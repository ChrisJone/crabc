-- 创建库
CREATE DATABASE IF NOT EXISTS crabc default charset utf8mb4 COLLATE utf8mb4_0900_ai_ci;
-- 建表
use crabc;
CREATE TABLE `base_api_info` (
  `api_id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `api_name` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `api_path` varchar(1000) DEFAULT NULL COMMENT 'API路径',
  `api_type` varchar(50) DEFAULT NULL COMMENT 'API类型：sql、table',
  `api_method` varchar(50) DEFAULT NULL COMMENT '请求方式 get、post、put、delete、aptch',
  `auth_type` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '授权类型：none、code、secret',
  `enabled` int DEFAULT NULL COMMENT '开放启用 1/0',
  `api_status` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT 'API状态：编辑edit、审批audit、发布release、销毁destroy',
  `group_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '分组ID',
  `parent_id` bigint DEFAULT NULL COMMENT '父级关联Id',
  `tenant_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '租户ID',
  `release_time` datetime DEFAULT NULL COMMENT '发布时间',
  `remarks` varchar(1000) DEFAULT NULL COMMENT '描述',
  `version` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '版本',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `update_by` varchar(128) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`api_id`)
) ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='API信息表';

CREATE TABLE `base_api_sql` (
  `sql_id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `api_id` bigint NOT NULL COMMENT 'API自增主键',
  `sql_script` text COMMENT 'sql语句脚本',
  `page_setup` int DEFAULT NULL COMMENT '分页设置，不分页：0、只分页：1、分页并统计：2',
  `datasource_id` varchar(128) NOT NULL COMMENT '数据源ID',
  `datasource_type` varchar(50) DEFAULT NULL COMMENT '数据源类型',
  `schema_name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT 'schema多个逗号分割',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `update_by` varchar(128) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`sql_id`)
) ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='API_SQL配置';

CREATE TABLE `base_datasource` (
  `datasource_id` int NOT NULL AUTO_INCREMENT,
  `datasource_name` varchar(256) DEFAULT NULL COMMENT '数据源名称',
  `datasource_type` varchar(50) DEFAULT NULL COMMENT '数据源类型',
  `classify` varchar(50) DEFAULT NULL COMMENT '分类',
  `jdbc_url` varchar(512) DEFAULT NULL COMMENT '链接地址',
  `host` varchar(50) DEFAULT NULL COMMENT '服务器地址',
  `port` varchar(10) DEFAULT NULL COMMENT '端口',
  `username` varchar(100) DEFAULT NULL COMMENT '账号',
  `password` varchar(100) DEFAULT NULL COMMENT '秘密',
  `remarks` text,
  `extend` text COMMENT '扩展配置',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `update_by` varchar(128) DEFAULT NULL,
  PRIMARY KEY (`datasource_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='数据源配置';

CREATE TABLE `base_api_group` (
  `group_id` int NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `parent_id` int NOT NULL COMMENT '父类Id',
  `group_name` varchar(500) NOT NULL,
  `group_desc` varchar(1000) DEFAULT NULL COMMENT '描述',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `update_by` varchar(128) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`group_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='分组表';

CREATE TABLE `base_sys_user` (
  `user_id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `user_name` varchar(30) NOT NULL COMMENT '用户账号',
  `nick_name` varchar(30) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '用户名称',
  `user_type` varchar(2) DEFAULT '0' COMMENT '用户类型',
  `password` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT '' COMMENT '密码',
  `dept_id` bigint DEFAULT NULL COMMENT '部门ID',
  `email` varchar(50) DEFAULT '' COMMENT '用户邮箱',
  `phone` varchar(13) DEFAULT '' COMMENT '手机号码',
  `sex` char(1) DEFAULT '0' COMMENT '用户性别（0男 1女 2未知）',
  `picture` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT '' COMMENT '头像',
  `status` char(1) DEFAULT '0' COMMENT '帐号状态（0正常 1停用）',
  `create_by` varchar(64) DEFAULT '' COMMENT '创建者',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT '' COMMENT '更新者',
  `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  PRIMARY KEY (`user_id`)
) ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='用户信息表';

CREATE TABLE `base_app` (
  `app_id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `app_name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT '应用名创',
  `app_desc` varchar(300) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '描述',
  `app_code` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT 'code简单认证',
  `app_key` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '密钥key',
  `app_secret` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '密钥',
  `strategy_type` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '控制策略类型：白名单：white、黑名单black',
  `ips` varchar(1000) DEFAULT NULL COMMENT 'IP地址，多个分号隔开',
  `enabled` int DEFAULT NULL COMMENT '状态：1启用，0禁用',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `update_by` varchar(128) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`app_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='应用';

CREATE TABLE `base_app_api` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `app_id` bigint NOT NULL COMMENT '应用ID',
  `api_id` bigint DEFAULT NULL COMMENT 'ApiId',
  `create_by` varchar(128) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='应用与API授权关系';